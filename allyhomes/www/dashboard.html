{% extends "templates/web.html" %}

{% block title %} Dashboard {% endblock %}
{% block page_sidebar %}
{% include "templates/pages/web_sidebar.html" %}
{% endblock %}
{% block page_content %}

<head>

<!--Sylesheets and JavaScript files to be included-->
<link href="/assets/allyhomes/css/fullcalendar.css" rel="stylesheet" />
<link href="/assets/allyhomes/css/fullcalendar.print.css" rel="stylesheet" media="print" />
<script src="/assets/allyhomes/js/moment.min.js"></script>
<script src="/assets/allyhomes/js/jquery.min.js"></script>  
<script src="/assets/allyhomes/js/fullcalendar.min.js"></script>

<script>
	var $j = jQuery.noConflict();
$j(document).ready(function() {
		
/*	var obj=[
		{title: 'All Day Event',start: '2016-09-02'},
		{title: 'Lunch',start: '2016-09-12T12:00:00'},
		{title: 'Birthday Party',start: '2016-12-13T07:00:00'}
	];

	var my_events=[];
	
	var myobj=function(start, end, timezone, callback) {
        frappe.call({
			type: "POST",
			method: "allyhomes.www.dashboard.get_events",
			args: {                
                start: "2016-08-31",
                end: "2016-09-31"
            },
            callback: function(r) {
				if(r.message){
			//		my_events = [];
			console.log("=====================================================================");
			console.log(end.unix());
					$.each(r.message,function(i,currItem) {
						my_events.push({
							title: currItem['title'],
							start: currItem['start'] // will be parsed
						});
					});
				}
				else
				{
				}
			}
		});
	}
	*/
//	alert(my_events);
	
	$j('#calendar').fullCalendar({        
		header: {
			left: 'prev,next today',
			center: 'title',
			right: 'month,basicWeek,basicDay'
		},
		defaultDate: '2016-09-08',
		editable: true,
		eventLimit: true, // allow "more" link when too many events
		events: function(start, end, timezone, callback) {
			$.ajax({
				url: '/jsonfeed.py',
				dataType: 'xml',
				data: {
					// our hypothetical feed requires UNIX timestamps
					start: start.unix(),
					end: end.unix()
				},
				success: function(doc) {
					var events = [];
					$(doc).find('event').each(function() {
						events.push({
							title: $(this).attr('title'),
							start: $(this).attr('start') // will be parsed
						});
					});
					callback(events);
				}
			});
		},  
	
/*		events: [		
		{		
			title: 'All Day Event',
			start: '2016-09-01'
		}.
		{
			title: 'Long Event',
			start: '2015-09-07',
			end: '2016-09-10'
		},
		{
			id: 999,
			title: 'Repeating Event',
			start: '2016-09-09T16:00:00'
		},
		{
			id: 999,
			title: 'Repeating Event',
			start: '2016-09-16T16:00:00'
		},
		{
			title: 'Conference',
			start: '2015-09-11',
			end: '2016-09-13'
		},
		{
			title: 'Meeting',
			start: '2016-09-12T10:30:00',
			end: '2016-09-12T12:30:00'
		},
		{
			title: 'Lunch',
			start: '2016-09-12T12:00:00'
		},
		{
			title: 'Meeting',
			start: '2016-09-12T14:30:00'
		},
		{
			title: 'Happy Hour',
			start: '2016-09-12T17:30:00'
		},
		{
			title: 'Dinner',
			start: '2016-09-12T20:00:00'
		},
		{
			title: 'Birthday Party',
			start: '2016-09-13T07:00:00'
		},
		{
			title: 'Click for Google',
			url: 'http://google.com/',
			start: '2016-09-28'
		}    
		]   */
	});
	$j('#calendar').on("change", function() {
		alert("Helloo");
	});
});
</script>
<!--Styling for calendar-->
<style>
body {
	margin: 5px 5px;
	padding: 0;
	font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
	font-size: 14px;
}
#calendar {
	max-width:900px;
	margin: 0 auto;
}
</style>
</head>

<body>
<div class="sections">
	<div class="container-fluid">
		<div class="row">	
			<div class="col-sm-4">
				<div class="panel panel-default">
					<table class="table table-hover">
						<caption>AGING REPORT</caption>
						<thead>
						 	<tr>
								<th>Name</th>
								<th>Customer</th>
								<th>Amount</th>
								<th>Delivery Date</th>							
						  	</tr>
						</thead>
						<tbody>
							{% for list in so_list -%}	
				  			<tr>
								<td>{{ list['name'] }}</td>
								<td>{{ list['customer'] }}</td>
								<td>{{ list['Total'] }}</td>
								<td>{{ list['delivery_date'] }}</td>					
				  			</tr>	
				  			{%- endfor %}    			  		
						</tbody>
					</table>
				</div>
			</div>		
        	<div class="col-sm-6">
            	<div id="calendar"></div>
        	</div>
        
        	<div class="col-sm-2">	
				<div class="panel panel-default">							
				<table class="table table-hover">
						<caption>Subs Available</caption>
						<thead>
						 	<tr>
								<th>Name</th>														
						  	</tr>
						</thead>
						<tbody>
							{% for list in subs -%}	
				  			<tr>
								<td>{{ list['name'] }}</td>													
				  			</tr>	
				  			{%- endfor %}    			  		
						</tbody>
					</table>
					</div>
			</div>
    	</div>
    </div>
</div>
</body>

{% endblock %}
